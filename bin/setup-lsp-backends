#!/bin/bash -x

# Stop on failure
set -e

# c++ (cquery)
pushd ~/wa/git

if [ ! -e cquery ] ; then
    git rclone https://github.com/cquery-project/cquery.git
else
    pushd cquery
    git pull
    git sub-update
    popd
fi

mkdir -p cquery/build

pushd cquery/build

local_cmake ..
make
make install

popd

popd

# python
# TODO: certificates
pip install --user 'python-language-server[all]'

# Go
go get -u github.com/sourcegraph/go-langserver

# Java
rm -rf ~/.emacs.d/eclipse.jdt.ls/server/
mkdir -p ~/.emacs.d/eclipse.jdt.ls/server/
wget http://download.eclipse.org/jdtls/snapshots/jdt-language-server-latest.tar.gz -O /tmp/jdt-latest.tar
tar xf /tmp/jdt-latest.tar -C ~/.emacs.d/eclipse.jdt.ls/server/
